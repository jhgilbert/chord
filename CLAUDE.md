# Chord

## Chord features

You can quickly come up to speed on Chord's features by reading the [feature tour](e2e/README.md) generated from the e2e tests.

## Code conventions

To keep the code readable for humans, avoid long chunks of logic that are "anonymous," meaning they do not have a name, so the human must figure out what they do.

Examples:

- A long inline callback to `onClick`, for example, might work better as a separate function at the bottom of the file.
- A deeply indented, long run of JSX serving as a subcomponent might work better as its own dedicated component at the bottom of the file.

When such an extraction would make the code harder for robots (and maybe even humans) to read, skip it.

## Refactoring

After you update a file's code, give it a scan for.

- duplicated code that could be refactored into a shared function or component
- inefficient algorithms that could be improved, such as a sequence of `.filter` calls that could instead be achieved with one loop that categorizes entries into multiple buckets

## Synchronicity

When the name of something in the UI changes, change the relevant names in the code too, unless the change will break backward compatibility with data that's already in prod.

## Component tests

The `src/__test__` folder contains component tests. When you add or update a component, also add or update tests.

## E2E Tests and README

After making UI changes that affect user-facing behavior, check whether these need updating:

- **E2E test**: `e2e/collaboration.spec.ts` — covers the full collaboration lifecycle
- **README demo**: `e2e/README.md` — a feature tour illustrated with screenshots generated by the e2e test

When a new feature is added that would make sense in a sentence that starts with "The host can ..." or "Participants can ..." (for example, "The host can mark notes as duplicates"), make sure the e2e testing for that feature includes a screenshot of the feature being used.

When an action taken by a user should disallow another user from doing something (for example, the host marking a note as duplicate means that participants should NOT see it in their inboxes, or the host revoking a user's access means the user should not be able to access the collaboration), make sure the e2e tests include checks for it.

If needed, also regenerate the test screenshots by running:

```
npx playwright test --update-snapshots
```
